<html>
<head>
    <title>Tidéns fantastiska familjereceptssamlingsportal</title>
    <script type="text/javascript" src="yaml.min.0.3.0.js"></script>
    <script src="https://unpkg.com/petite-vue"></script>
    <meta charset="UTF-8"> 
    <link rel="stylesheet" href="style.css">

    <script type="module">
        function onlyUnique(value, index, array) {
            return array.indexOf(value) === index;
        }
        let recepten = YAML.load('data.yml');


        const urlParams = new URLSearchParams(window.location.search);
        const q = urlParams.get('q');


        // alert(JSON.stringify(recepten));
        PetiteVue.createApp({
            recepten: recepten,
            allataggar: recepten.flatMap(recept => recept.tags).filter(onlyUnique).sort(),
            filter: q,
            get receptenFiltered() {
                if (this.filter) {
                    return recepten.filter(r => JSON.stringify(r).toUpperCase().indexOf(this.filter.toUpperCase()) !== -1);
                } else {
                    return recepten;
                }
            }
        }).mount()
    </script>
</head>
<!--- ----------------------------------------------------------------->
<!--- ----------------------------------------------------------------->
<!--- ----------------------------------------------------------------->
<!--- ----------------------------------------------------------------->
<!--- ----------------------------------------------------------------->

<body>
    <header>
        <h1>Tidéns fantastiska familjereceptssamlingsportal</h1>

        <label for="sök">
            Sök här:
            <input id="sök" type="text" v-model="filter"></input>
        </label>
        <div>
            <a class="taggar" :href="`?q=${tag}`" v-for="tag in allataggar">#{{tag}}</a>
        </div>
    </header>
    <main>
        
        <div class="receptList">
            <div v-for="recept in receptenFiltered" class="receptCard" >
                <img class="receptImage" :src="recept.bild" alt="Receptbild">
                <h2>{{recept.name}}</h2>
                <a class="taggar" :href="`?q=${tag}`" v-for="tag in recept.tags">#{{tag}}</a>
                <ul>
                    <li v-for="ingrediens in recept.ingredienser">{{ingrediens}}</li>
                </ul>
                
                <hr/>
                <ol>
                    <li v-for="instruktion in recept.instruktioner">{{instruktion}}</li>
                </ol>
            </div>
        </div>
    </main>
    <footer>footer</footer>
</body>
</html>